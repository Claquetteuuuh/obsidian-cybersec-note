# Tshark VS Wireshark
![[Pasted image 20250309150335.png]]
# Parameters

| **Parameter**    | **Purpose**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| -h               | - Display the help page with the most common features.<br>- `tshark -h`                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| -v               | - Show version info.<br>- `tshark -v`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -D               | - List available sniffing interfaces.<br>- `tshark -D`                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -i               | - Choose an interface to capture live traffic.<br>- `tshark -i 1`<br>- `tshark -i ens55`                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **No Parameter** | - Sniff the traffic like tcpdump.<br>- `tshark`                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -r               | - Read/input function. Read a capture file.<br>- `tshark -r demo.pcapng`                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| -c               | - Packet count. Stop after capturing a specified number of packets.<br>- E.g. stop after capturing/filtering/reading 10 packets.<br>- `tshark -c 10`                                                                                                                                                                                                                                                                                                                                                                 |
| -w               | - Write/output function. Write the sniffed traffic to a file.<br>- `tshark -w sample-capture.pcap`                                                                                                                                                                                                                                                                                                                                                                                                                   |
| -V               | - Verbose.<br>- Provide detailed information **for each packet**. This option will provide details similar to Wireshark's "Packet Details Pane".<br>- `tshark -V`                                                                                                                                                                                                                                                                                                                                                    |
| -q               | - Silent mode.<br>- Suspress the packet outputs on the terminal.<br>- `tshark -q`                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -x               | - Display packet bytes.<br>- Show packet details in hex and ASCII dump for each packet.<br>- `tshark -x`                                                                                                                                                                                                                                                                                                                                                                                                             |
|                  | Define capture conditions for a single run/loop. STOP after completing the condition. Also known as "Autostop".                                                                                                                                                                                                                                                                                                                                                                                                      |
| -a               | - **Duration:** Sniff the traffic and stop after X seconds. Create a new file and write output to it.  <br>    <br><br>- `tshark -w test.pcap -a duration:1`<br><br>- **Filesize:** Define the maximum capture file size. Stop after reaching X file size (KB).<br><br>- `tshark -w test.pcap -a filesize:10`<br><br>- **Files:** Define the maximum number of output files. Stop after X files.<br><br>- `tshark -w test.pcap -a filesize:10 -a files:3`                                                            |
|                  | Ring buffer control options. Define capture conditions for multiple runs/loops. (INFINITE LOOP).                                                                                                                                                                                                                                                                                                                                                                                                                     |
| -b               | - **Duration:** Sniff the traffic for X seconds, create a new file and write output to it.   <br>    <br><br>- `tshark -w test.pcap -b duration:1`<br><br>- **Filesize:** Define the maximum capture file size. Create a new file and write output to it after reaching filesize X (KB).<br><br>- `tshark -w test.pcap -b filesize:10`<br><br>- **Files:** Define the maximum number of output files. Rewrite the first/oldest file after creating X files.<br><br>- `tshark -w test.pcap -b filesize:10 -b files:3` |
