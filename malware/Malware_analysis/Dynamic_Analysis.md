# Sandbox
The sandbox is the terrain where an operation has to take place. In malware analysis it's an **isolated evironment** **mimicking** the actual **target** environment of a malware where an analyst runs a sample to learn more about it.
## Construction
- Virtual machine mimicking the actual target environment of the malware.
- Ability to take snapshots and revert to clean state
- OS monitoring software, Procmon, ProcExplorer, Regshot...
- Network monitoring software, Wireshark, tcpdump...
- Control over the network through a dummy DNS server and webserver
- A mechanism to move analysis logs and malware samples in and out of the Virtual Machine without compromising the host.
## Opensource sandbox
### Cuckoo's Sandbox
[Cuckoo's sandbox](https://github.com/cuckoosandbox/cuckoo) is the most widely known sandbox in the malware analysis community. It was developed as part of a Google Summer of Code project in 2010. It is an open-source project that you will often see deployed in SOC environments and with enthusiasts' home labs.
#### Advantage:
- Huge community support
- Easy to understand documentation
- A lot of customizations
Cuckoo's sandbox has been archived, and an update is pending. It also doesn't support Python 3, making it obsolete right now. However, all is not lost because we have alternatives.
### CAPE Sandbox
[CAPE Sandbox](https://github.com/kevoreilly/CAPEv2) is a little more advanced version of Cuckoo's sandbox. It supports debugging and memory dumping to support the unpacking of packed malware.
### Online Sandboxes
- [Online Cuckoo Sandbox](https://cuckoo.cert.ee/)
- [Any.run](https://any.run/)
- [Intezer](https://analyze.intezer.com/)
- [Hybrid Analysis](https://hybrid-analysis.com/)
## Analyzing samples using Hybrid Analysis
![[Pasted image 20250314185626.png]]
You can put a hash:
![[Pasted image 20250314185649.png]]
If you click on one of it:
![[Pasted image 20250314185728.png]]

If you click on overview and then `view all details` you can see the mapping to MITRE ATT&CK techniques:
![[Pasted image 20250314185902.png]]

In the Hybrid analysis you can see the process run by the malware:
![[Pasted image 20250314190419.png]]