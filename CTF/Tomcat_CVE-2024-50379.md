https://nvd.nist.gov/vuln/detail/CVE-2024-50379
Apache Tomcat is an open-source web server and serverlet container. 
A **serverlet** is a Java class created to run an application server and handle client requests.

This CVE impact the following versions of Apache Tomcat:
- Apache Tomcat 11.0.0-M1 to 11.0.1 (Fixed in 11.0.2 or later)
- Apache Tomcat 10.1.0-M1 to 10.1.33 (Fixed in 10.1.34 or later)
- Apache Tomcat 9.0.0.M1 to 9.0.97 (Fixed in 9.0.98 or later)

This vulnerability is an exemple of Time-of-check Time-of-use (TOCTOU) vuln.
# Technical background
## Conditions
There is 2 conditions to exploit this vulnerability.
### 1. Allow upload and delete files
The server is configured to accept HTTP commands such as PUT and DELETE.

Writing is enabled by setting `readonly` to `false` in the `web.xml` configuration file. Note that the default configuration is readonly.
```xml
<init-param>
  <param-name>readonly</param-name>
  <param-value>false</param-value>
</init-param>
```

Here is an exemple of insecure configuration:
```xml
<servlet>
  <servlet-name>default</servlet-name>
  <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>
  <init-param>
    <param-name>debug</param-name>
    <param-value>0</param-value>
  </init-param>
  <init-param>
    <param-name>listings</param-name>
    <param-value>false</param-value>
  </init-param>
  <init-param>
    <param-name>readonly</param-name>
    <param-value>false</param-value>
  </init-param>
  <load-on-startup>1</load-on-startup>
</servlet>
```
### 2. Run Tomcat in case-insensitive system
The second condition for exploiting this vulnerability is for Tomcat to run on a case-insensitive system, such as MS Windows or macOS.

On case-sensitive systems like Linux, `demo.jsp` and `demo.Jsp` are two different files.

But MS Windows would treat `demo.Jsp` no different than it would treat a servlet properly named `demo.jsp`.

