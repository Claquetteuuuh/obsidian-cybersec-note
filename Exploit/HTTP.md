# Version
Use the `auxiliary/scanner/http/http_version` module to get the version of the http server
```bash
msf6 > use auxiliary/scanner/http/http_version
msf6 auxiliary(scanner/http/http_version) > run

[+] 192.119.123.3:80 Apache/2.4.18 (Ubuntu)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Headers
Use the `auxiliary/scanner/http/http_header` module to get the headers
## Configure the method
```bash
msf6 auxiliary(scanner/http/http_header) > set HTTP_METHOD GET
HTTP_METHOD => GET
```
## Run 
```bash
msf6 auxiliary(scanner/http/http_header) > run

[+] 192.119.123.3:80     : CONTENT-TYPE: text/html
[+] 192.119.123.3:80     : LAST-MODIFIED: Wed, 28 Aug 2024 08:56:57 GMT
[+] 192.119.123.3:80     : SERVER: Apache/2.4.18 (Ubuntu)
[+] 192.119.123.3:80     : detected 3 headers
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Robots.txt
Use the module
```bash
msf6 > use auxiliary/scanner/http/robots_txt
msf6 auxiliary(scanner/http/robots_txt) > run

[*] [192.119.123.3] /robots.txt found
[+] Contents of Robots.txt:
# robots.txt for attackdefense 
User-agent: test                     
# Directories
Allow: /webmail

User-agent: *
# Directories
Disallow: /data
Disallow: /secure

[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Requests
Make a request with curl
```bash
msf6 > curl http://192.119.123.3/data/
[*] exec: curl http://192.119.123.3/data/

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
 <head>
  <title>Index of /data</title>
 </head>
 <body>
<h1>Index of /data</h1>
  <table>
   <tr><th valign="top"><img src="/icons/blank.gif" alt="[ICO]"></th><th><a href="?C=N;O=D">Name</a></th><th><a href="?C=M;O=A">Last modified</a></th><th><a href="?C=S;O=A">Size</a></th><th><a href="?C=D;O=A">Description</a></th></tr>
   <tr><th colspan="5"><hr></th></tr>
<tr><td valign="top"><img src="/icons/back.gif" alt="[PARENTDIR]"></td><td><a href="/">Parent Directory</a></td><td>&nbsp;</td><td align="right">  - </td><td>&nbsp;</td></tr>
   <tr><th colspan="5"><hr></th></tr>
</table>
<address>Apache/2.4.18 (Ubuntu) Server at 192.119.123.3 Port 80</address>
</body></html>
```
# Scan
## directory
To scan directory, use the `auxiliary/scanner/http/dir_scanner`
```bash
msf6 auxiliary(scanner/http/dir_scanner) > run

[*] Detecting error code
[*] Using code '404' as not found for 192.165.110.3
[+] Found http://192.165.110.3:80/cgi-bin/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/data/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/downloads/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/doc/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/icons/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/manual/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/secure/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/uploads/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/users/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/webadmin/ 200 (192.165.110.3)
[+] Found http://192.165.110.3:80/web_app/ 200 (192.165.110.3)
[+] Found http://192.165.110.3:80/view/ 200 (192.165.110.3)
[+] Found http://192.165.110.3:80/webmail/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/webdb/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/webdav/ 404 (192.165.110.3)
[+] Found http://192.165.110.3:80/~nobody/ 404 (192.165.110.3)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
## File
```bash
msf6 > auxiliary/scanner/http/files_dir
msf6 auxiliary(scanner/http/files_dir) > run

[*] Using code '404' as not found for files with extension .null
[*] Using code '404' as not found for files with extension .backup
[+] Found http://192.165.110.3:80/file.backup 200
[*] Using code '404' as not found for files with extension .bak
[*] Using code '404' as not found for files with extension .c
[+] Found http://192.165.110.3:80/code.c 200
[*] Using code '404' as not found for files with extension .cfg
[+] Found http://192.165.110.3:80/code.cfg 200
[*] Using code '404' as not found for files with extension .class
[*] Using code '404' as not found for files with extension .copy
[*] Using code '404' as not found for files with extension .conf
```
# Bruteforcing
You can set the "VERBOSE" option => false to show only legitimate credentials
```bash
msf6 > use auxiliary/scanner/http/http_login
msf6 auxiliary(scanner/http/http_login) > set AUTH_URI <FORM_URL>
[*Â²] Attempting to login to http://192.165.110.3:80/secure/
[-] 192.165.110.3:80 - Failed: 'admin:admin'
...
[+] 192.165.110.3:80 - Success: 'bob:123321'
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# User Enum
To enumerate the user try the `auxiliary/scanner/http/apache_userdir_enum` module
```bash
msf6 > use auxiliary/scanner/http/apache_userdir_enum

msf6 auxiliary(scanner/http/apache_userdir_enum) > set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
USER_FILE => /usr/share/metasploit-framework/data/wordlists/common_users.txt
msf6 auxiliary(scanner/http/apache_userdir_enum) > run

[*] http://192.165.110.3/~sysadmin - Trying UserDir: 'sysadmin'
...
[*] http://192.165.110.3/~alice - Trying UserDir: 'alice'
[+] http://192.165.110.3/ - Apache UserDir: 'alice' found 
[+] http://192.165.110.3/ - Users found: alice, backup, bin, bob, daemon, games, gnats, irc, list, lp, mail, man, news, nobody, proxy, sync, sys, uucp
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```